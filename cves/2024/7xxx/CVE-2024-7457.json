{
    "dataType": "CVE_RECORD",
    "dataVersion": "5.1",
    "cveMetadata": {
        "cveId": "CVE-2024-7457",
        "assignerOrgId": "41c37e40-543d-43a2-b660-2fee83ea851a",
        "state": "PUBLISHED",
        "assignerShortName": "Pentraze",
        "dateReserved": "2024-08-04T02:47:51.335Z",
        "datePublished": "2025-06-10T23:19:47.186Z",
        "dateUpdated": "2025-06-11T13:52:22.705Z"
    },
    "containers": {
        "cna": {
            "affected": [
                {
                    "collectionURL": "https://stash.ws/",
                    "defaultStatus": "unaffected",
                    "packageName": "ws.stash.app.mac.daemon.helper",
                    "platforms": [
                        "MacOS"
                    ],
                    "product": "Stash",
                    "vendor": "Stash",
                    "versions": [
                        {
                            "lessThanOrEqual": "build 303",
                            "status": "affected",
                            "version": "0",
                            "versionType": "custom"
                        }
                    ]
                }
            ],
            "credits": [
                {
                    "lang": "en",
                    "type": "finder",
                    "value": "Carlos Garrido of Pentraze Cybersecurity"
                }
            ],
            "datePublic": "2025-06-10T16:00:00.000Z",
            "descriptions": [
                {
                    "lang": "en",
                    "supportingMedia": [
                        {
                            "base64": false,
                            "type": "text/html",
                            "value": "<p>\nThe <code>ws.stash.app.mac.daemon.helper</code> tool contains a vulnerability caused by an incorrect use of macOS’s authorization model. Instead of validating the client's authorization reference, the helper invokes <code>AuthorizationCopyRights()</code> using its own privileged context (<code>root</code>), effectively authorizing itself rather than the client. As a result, it grants the <code>system.preferences.admin</code> right internally, regardless of the requesting client's privileges. This flawed logic allows unprivileged clients to invoke privileged operations via XPC, including unauthorized changes to system-wide network preferences such as SOCKS, HTTP, and HTTPS proxy settings. The absence of proper code-signing checks further enables arbitrary processes to exploit this flaw, leading to man-in-the-middle (MITM) attacks through traffic redirection.\n\n</p>"
                        }
                    ],
                    "value": "The ws.stash.app.mac.daemon.helper tool contains a vulnerability caused by an incorrect use of macOS’s authorization model. Instead of validating the client's authorization reference, the helper invokes AuthorizationCopyRights() using its own privileged context (root), effectively authorizing itself rather than the client. As a result, it grants the system.preferences.admin right internally, regardless of the requesting client's privileges. This flawed logic allows unprivileged clients to invoke privileged operations via XPC, including unauthorized changes to system-wide network preferences such as SOCKS, HTTP, and HTTPS proxy settings. The absence of proper code-signing checks further enables arbitrary processes to exploit this flaw, leading to man-in-the-middle (MITM) attacks through traffic redirection."
                }
            ],
            "impacts": [
                {
                    "capecId": "CAPEC-233",
                    "descriptions": [
                        {
                            "lang": "en",
                            "value": "CAPEC-233 Privilege Escalation"
                        }
                    ]
                }
            ],
            "metrics": [
                {
                    "cvssV3_1": {
                        "attackComplexity": "LOW",
                        "attackVector": "LOCAL",
                        "availabilityImpact": "HIGH",
                        "baseScore": 7.8,
                        "baseSeverity": "HIGH",
                        "confidentialityImpact": "HIGH",
                        "integrityImpact": "HIGH",
                        "privilegesRequired": "LOW",
                        "scope": "UNCHANGED",
                        "userInteraction": "NONE",
                        "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
                        "version": "3.1"
                    },
                    "format": "CVSS",
                    "scenarios": [
                        {
                            "lang": "en",
                            "value": "GENERAL"
                        }
                    ]
                }
            ],
            "problemTypes": [
                {
                    "descriptions": [
                        {
                            "cweId": "CWE-863",
                            "description": "CWE-863 Incorrect Authorization",
                            "lang": "en",
                            "type": "CWE"
                        }
                    ]
                }
            ],
            "providerMetadata": {
                "orgId": "41c37e40-543d-43a2-b660-2fee83ea851a",
                "shortName": "Pentraze",
                "dateUpdated": "2025-06-10T23:19:47.186Z"
            },
            "references": [
                {
                    "url": "https://pentraze.com/"
                }
            ],
            "source": {
                "discovery": "UNKNOWN"
            },
            "title": "macOS Stash network-management utility: Unauthorized Manipulation of System Network Preferences",
            "x_generator": {
                "engine": "Vulnogram 0.2.0"
            }
        },
        "adp": [
            {
                "metrics": [
                    {
                        "other": {
                            "type": "ssvc",
                            "content": {
                                "timestamp": "2025-06-11T13:52:10.272705Z",
                                "id": "CVE-2024-7457",
                                "options": [
                                    {
                                        "Exploitation": "none"
                                    },
                                    {
                                        "Automatable": "no"
                                    },
                                    {
                                        "Technical Impact": "total"
                                    }
                                ],
                                "role": "CISA Coordinator",
                                "version": "2.0.3"
                            }
                        }
                    }
                ],
                "title": "CISA ADP Vulnrichment",
                "providerMetadata": {
                    "orgId": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
                    "shortName": "CISA-ADP",
                    "dateUpdated": "2025-06-11T13:52:22.705Z"
                }
            }
        ]
    }
}