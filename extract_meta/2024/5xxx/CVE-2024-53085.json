{
  "CVE Code": "CVE-2024-53085",
  "Published": "2024-11-19T17:45:14.209Z",
  "Updated": "2025-05-04T13:00:17.431Z",
  "Description": "In the Linux kernel, the following vulnerability has been resolved:\n\ntpm: Lock TPM chip in tpm_pm_suspend() first\n\nSetting TPM_CHIP_FLAG_SUSPENDED in the end of tpm_pm_suspend() can be racy\naccording, as this leaves window for tpm_hwrng_read() to be called while\nthe operation is in progress. The recent bug report gives also evidence of\nthis behaviour.\n\nAadress this by locking the TPM chip before checking any chip->flags both\nin tpm_pm_suspend() and tpm_hwrng_read(). Move TPM_CHIP_FLAG_SUSPENDED\ncheck inside tpm_get_random() so that it will be always checked only when\nthe lock is reserved.",
  "ProblemTypes": [
    "N/A"
  ],
  "Affected": [
    {
      "vendor": "Linux",
      "product": "Linux",
      "versions": [
        "99d46450625590d410f86fe4660a5eff7d3b8343",
        "99d46450625590d410f86fe4660a5eff7d3b8343",
        "99d46450625590d410f86fe4660a5eff7d3b8343",
        "7cd46930b8bf37b84777410ac21bfdf1179021d5",
        "eeda114c92c7b2db69878cdf27163750fd57cfe2"
      ]
    },
    {
      "vendor": "Linux",
      "product": "Linux",
      "versions": [
        "6.4",
        "0",
        "6.6.64",
        "6.11.8",
        "6.12"
      ]
    }
  ],
  "Reference": [
    "https://git.kernel.org/stable/c/cfaf83501a0cbb104499c5b0892ee5ebde4e967f",
    "https://git.kernel.org/stable/c/bc203fe416abdd1c29da594565a7c3c4e979488e",
    "https://git.kernel.org/stable/c/9265fed6db601ee2ec47577815387458ef4f047a"
  ]
}