{
  "CVE Code": "CVE-2024-38580",
  "Published": "2024-06-19T13:37:37.840Z",
  "Updated": "2025-05-04T09:14:33.781Z",
  "Description": "In the Linux kernel, the following vulnerability has been resolved:\n\nepoll: be better about file lifetimes\n\nepoll can call out to vfs_poll() with a file pointer that may race with\nthe last 'fput()'. That would make f_count go down to zero, and while\nthe ep->mtx locking means that the resulting file pointer tear-down will\nbe blocked until the poll returns, it means that f_count is already\ndead, and any use of it won't actually get a reference to the file any\nmore: it's dead regardless.\n\nMake sure we have a valid ref on the file pointer before we call down to\nvfs_poll() from the epoll routines.",
  "ProblemTypes": [
    "N/A"
  ],
  "Affected": [
    {
      "vendor": "Linux",
      "product": "Linux",
      "versions": [
        "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2",
        "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2",
        "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2",
        "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2",
        "1da177e4c3f41524e886b7f1b8a0c1fc7321cac2"
      ]
    },
    {
      "vendor": "Linux",
      "product": "Linux",
      "versions": [
        "5.15.161",
        "6.1.93",
        "6.6.33",
        "6.8.12",
        "6.9"
      ]
    }
  ],
  "Reference": [
    "https://git.kernel.org/stable/c/cbfd1088e24ec4c1199756a37cb8e4cd0a4b016e",
    "https://git.kernel.org/stable/c/559214eb4e5c3d05e69428af2fae2691ba1eb784",
    "https://git.kernel.org/stable/c/4f65f4defe4e23659275ce5153541cd4f76ce2d2",
    "https://git.kernel.org/stable/c/16e3182f6322575eb7c12e728ad3c7986a189d5d",
    "https://git.kernel.org/stable/c/4efaa5acf0a1d2b5947f98abb3acf8bfd966422b"
  ]
}