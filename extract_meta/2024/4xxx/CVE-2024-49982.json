{
  "CVE Code": "CVE-2024-49982",
  "Published": "2024-10-21T18:02:27.820Z",
  "Updated": "2025-05-04T12:59:17.641Z",
  "Description": "In the Linux kernel, the following vulnerability has been resolved:\n\naoe: fix the potential use-after-free problem in more places\n\nFor fixing CVE-2023-6270, f98364e92662 (\"aoe: fix the potential\nuse-after-free problem in aoecmd_cfg_pkts\") makes tx() calling dev_put()\ninstead of doing in aoecmd_cfg_pkts(). It avoids that the tx() runs\ninto use-after-free.\n\nThen Nicolai Stange found more places in aoe have potential use-after-free\nproblem with tx(). e.g. revalidate(), aoecmd_ata_rw(), resend(), probe()\nand aoecmd_cfg_rsp(). Those functions also use aoenet_xmit() to push\npacket to tx queue. So they should also use dev_hold() to increase the\nrefcnt of skb->dev.\n\nOn the other hand, moving dev_put() to tx() causes that the refcnt of\nskb->dev be reduced to a negative value, because corresponding\ndev_hold() are not called in revalidate(), aoecmd_ata_rw(), resend(),\nprobe(), and aoecmd_cfg_rsp(). This patch fixed this issue.",
  "ProblemTypes": [
    "N/A"
  ],
  "Affected": [
    {
      "vendor": "Linux",
      "product": "Linux",
      "versions": [
        "ad80c34944d7175fa1f5c7a55066020002921a99",
        "1a54aa506b3b2f31496731039e49778f54eee881",
        "faf0b4c5e00bb680e8e43ac936df24d3f48c8e65",
        "7dd09fa80b0765ce68bfae92f4e2f395ccf0fba4",
        "74ca3ef68d2f449bc848c0a814cefc487bf755fa",
        "eb48680b0255a9e8a9bdc93d6a55b11c31262e62",
        "f98364e926626c678fb4b9004b75cacf92ff0662",
        "f98364e926626c678fb4b9004b75cacf92ff0662",
        "f98364e926626c678fb4b9004b75cacf92ff0662",
        "079cba4f4e307c69878226fdf5228c20aa1c969c",
        "a16fbb80064634b254520a46395e36b87ca4731e"
      ]
    },
    {
      "vendor": "Linux",
      "product": "Linux",
      "versions": [
        "6.9",
        "0",
        "4.19.323",
        "5.4.285",
        "5.10.227",
        "5.15.168",
        "6.1.113",
        "6.6.55",
        "6.10.14",
        "6.11.3",
        "6.12"
      ]
    }
  ],
  "Reference": [
    "https://git.kernel.org/stable/c/12f7b89dd72b25da4eeaa22097877963cad6418e",
    "https://git.kernel.org/stable/c/a786265aecf39015418e4f930cc1c14603a01490",
    "https://git.kernel.org/stable/c/f63461af2c1a86af4217910e47a5c46e3372e645",
    "https://git.kernel.org/stable/c/07b418d50ccbbca7e5d87a3a0d41d436cefebf79",
    "https://git.kernel.org/stable/c/bc2cbf7525ac288e07d465f5a1d8cb8fb9599254",
    "https://git.kernel.org/stable/c/acc5103a0a8c200a52af7d732c36a8477436a3d3",
    "https://git.kernel.org/stable/c/89d9a69ae0c667e4d9d028028e2dcc837bae626f",
    "https://git.kernel.org/stable/c/8253a60c89ec35c8f36fb2cc08cdf854c7a3eb58",
    "https://git.kernel.org/stable/c/6d6e54fc71ad1ab0a87047fd9c211e75d86084a3"
  ]
}