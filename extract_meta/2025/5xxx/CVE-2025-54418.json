{
  "CVE Code": "CVE-2025-54418",
  "Published": "2025-07-28T14:47:20.887Z",
  "Updated": "2025-07-28T17:19:14.503Z",
  "Description": "CodeIgniter is a PHP full-stack web framework. A command injection vulnerability present in versions prior to 4.6.2 affects applications that use the ImageMagick handler for image processing (`imagick` as the image library) and either allow file uploads with user-controlled filenames and process uploaded images using the `resize()` method or use the `text()` method with user-controlled text content or options. An attacker can upload a file with a malicious filename containing shell metacharacters that get executed when the image is processed or provide malicious text content or options that get executed when adding text to images Users should upgrade to v4.6.2 or later to receive a patch. As a workaround, switch to the GD image handler (`gd`, the default handler), which is not affected by either vulnerability. For file upload scenarios, instead of using user-provided filenames, generate random names to eliminate the attack vector with `getRandomName()` when using the `move()` method, or use the `store()` method, which automatically generates safe filenames. For text operations, if one must use ImageMagick with user-controlled text, sanitize the input to only allow safe characters and validate/restrict text options.",
  "ProblemTypes": [
    "CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')"
  ],
  "Affected": [
    {
      "vendor": "codeigniter4",
      "product": "CodeIgniter4",
      "versions": [
        "< 4.6.2"
      ]
    }
  ],
  "Reference": [
    "https://github.com/codeigniter4/CodeIgniter4/security/advisories/GHSA-9952-gv64-x94c",
    "https://github.com/codeigniter4/CodeIgniter4/commit/e18120bff1da691e1d15ffc1bf553ae7411762c0",
    "https://cwe.mitre.org/data/definitions/78.html",
    "https://owasp.org/www-community/attacks/Command_Injection"
  ]
}