{
  "CVE Code": "CVE-2023-49799",
  "Published": "2023-12-08T23:45:18.581Z",
  "Updated": "2024-11-27T15:52:46.493Z",
  "Description": "`nuxt-api-party` is an open source module to proxy API requests. nuxt-api-party attempts to check if the user has passed an absolute URL to prevent the aforementioned attack. This has been recently changed to use the regular expression `^https?://`, however this regular expression can be bypassed by an absolute URL with leading whitespace. For example `\\nhttps://whatever.com` which has a leading newline. According to the fetch specification, before a fetch is made the URL is normalized. \"To normalize a byte sequence potentialValue, remove any leading and trailing HTTP whitespace bytes from potentialValue.\". This means the final request will be normalized to `https://whatever.com` bypassing the check and nuxt-api-party will send a request outside of the whitelist. This could allow us to leak credentials or perform Server-Side Request Forgery (SSRF). This vulnerability has been addressed in version 0.22.1. Users are advised to upgrade. Users unable to upgrade should revert to the previous method of detecting absolute URLs.",
  "ProblemTypes": [
    "CWE-918: Server-Side Request Forgery (SSRF)"
  ],
  "Affected": [
    {
      "vendor": "johannschopplich",
      "product": "nuxt-api-party",
      "versions": [
        "< 0.22.1"
      ]
    }
  ],
  "Reference": [
    "https://github.com/johannschopplich/nuxt-api-party/security/advisories/GHSA-3wfp-253j-5jxv",
    "https://fetch.spec.whatwg.org/",
    "https://fetch.spec.whatwg.org/#http-whitespace-byte",
    "https://github.com/johannschopplich/nuxt-api-party/blob/777462e1e3af1d9f8938aa33f230cd8cb6e0cc9a/src/runtime/server/handler.ts#L31",
    "https://infra.spec.whatwg.org/#byte-sequence"
  ]
}