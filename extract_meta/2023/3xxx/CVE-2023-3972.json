{
  "CVE Code": "CVE-2023-3972",
  "Published": "2023-11-01T15:54:52.093Z",
  "Updated": "2024-11-23T01:25:37.586Z",
  "Description": "A vulnerability was found in insights-client. This security issue occurs because of insecure file operations or unsafe handling of temporary files and directories that lead to local privilege escalation. Before the insights-client has been registered on the system by root, an unprivileged local user or attacker could create the /var/tmp/insights-client directory (owning the directory with read, write, and execute permissions) on the system. After the insights-client is registered by root, an attacker could then control the directory content that insights are using by putting malicious scripts into it and executing arbitrary code as root (trivially bypassing SELinux protections because insights processes are allowed to disable SELinux system-wide).",
  "ProblemTypes": [
    "Creation of Temporary File in Directory with Insecure Permissions"
  ],
  "Affected": [
    {
      "vendor": "Red Hat",
      "product": "Red Hat Enterprise Linux 7",
      "versions": [
        "0:3.1.9-1.el7_9"
      ]
    },
    {
      "vendor": "Red Hat",
      "product": "Red Hat Enterprise Linux 8",
      "versions": [
        "0:3.2.2-1.el8_8"
      ]
    },
    {
      "vendor": "Red Hat",
      "product": "Red Hat Enterprise Linux 8.1 Update Services for SAP Solutions",
      "versions": [
        "0:3.2.3-1.el8_1"
      ]
    },
    {
      "vendor": "Red Hat",
      "product": "Red Hat Enterprise Linux 8.2 Advanced Update Support",
      "versions": [
        "0:3.2.3-1.el8_2"
      ]
    },
    {
      "vendor": "Red Hat",
      "product": "Red Hat Enterprise Linux 8.2 Telecommunications Update Service",
      "versions": [
        "0:3.2.3-1.el8_2"
      ]
    },
    {
      "vendor": "Red Hat",
      "product": "Red Hat Enterprise Linux 8.2 Update Services for SAP Solutions",
      "versions": [
        "0:3.2.3-1.el8_2"
      ]
    },
    {
      "vendor": "Red Hat",
      "product": "Red Hat Enterprise Linux 8.4 Advanced Mission Critical Update Support",
      "versions": [
        "0:3.2.3-1.el8_4"
      ]
    },
    {
      "vendor": "Red Hat",
      "product": "Red Hat Enterprise Linux 8.4 Telecommunications Update Service",
      "versions": [
        "0:3.2.3-1.el8_4"
      ]
    },
    {
      "vendor": "Red Hat",
      "product": "Red Hat Enterprise Linux 8.4 Update Services for SAP Solutions",
      "versions": [
        "0:3.2.3-1.el8_4"
      ]
    },
    {
      "vendor": "Red Hat",
      "product": "Red Hat Enterprise Linux 8.6 Extended Update Support",
      "versions": [
        "0:3.2.2-1.el8_6"
      ]
    },
    {
      "vendor": "Red Hat",
      "product": "Red Hat Enterprise Linux 9",
      "versions": [
        "0:3.2.2-1.el9_2"
      ]
    },
    {
      "vendor": "Red Hat",
      "product": "Red Hat Enterprise Linux 9.0 Extended Update Support",
      "versions": [
        "0:3.2.2-1.el9_0"
      ]
    },
    {
      "vendor": "Red Hat",
      "product": "Red Hat Enterprise Linux 6",
      "versions": []
    }
  ],
  "Reference": [
    "https://access.redhat.com/errata/RHSA-2023:6264",
    "https://access.redhat.com/errata/RHSA-2023:6282",
    "https://access.redhat.com/errata/RHSA-2023:6283",
    "https://access.redhat.com/errata/RHSA-2023:6284",
    "https://access.redhat.com/errata/RHSA-2023:6795",
    "https://access.redhat.com/errata/RHSA-2023:6796",
    "https://access.redhat.com/errata/RHSA-2023:6798",
    "https://access.redhat.com/errata/RHSA-2023:6811",
    "https://access.redhat.com/security/cve/CVE-2023-3972",
    "https://bugzilla.redhat.com/show_bug.cgi?id=2227027",
    "https://github.com/RedHatInsights/insights-core/pull/3878"
  ]
}