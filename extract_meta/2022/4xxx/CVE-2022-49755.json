{
  "CVE Code": "CVE-2022-49755",
  "Published": "2025-03-27T16:43:02.950Z",
  "Updated": "2025-05-04T08:44:41.827Z",
  "Description": "In the Linux kernel, the following vulnerability has been resolved:\n\nusb: gadget: f_fs: Prevent race during ffs_ep0_queue_wait\n\nWhile performing fast composition switch, there is a possibility that the\nprocess of ffs_ep0_write/ffs_ep0_read get into a race condition\ndue to ep0req being freed up from functionfs_unbind.\n\nConsider the scenario that the ffs_ep0_write calls the ffs_ep0_queue_wait\nby taking a lock &ffs->ev.waitq.lock. However, the functionfs_unbind isn't\nbounded so it can go ahead and mark the ep0req to NULL, and since there\nis no NULL check in ffs_ep0_queue_wait we will end up in use-after-free.\n\nFix this by making a serialized execution between the two functions using\na mutex_lock(ffs->mutex).",
  "ProblemTypes": [
    "N/A"
  ],
  "Affected": [
    {
      "vendor": "Linux",
      "product": "Linux",
      "versions": [
        "ddf8abd2599491cbad959c700b90ba72a5dce8d0",
        "ddf8abd2599491cbad959c700b90ba72a5dce8d0",
        "ddf8abd2599491cbad959c700b90ba72a5dce8d0",
        "ddf8abd2599491cbad959c700b90ba72a5dce8d0",
        "ddf8abd2599491cbad959c700b90ba72a5dce8d0",
        "ddf8abd2599491cbad959c700b90ba72a5dce8d0",
        "ddf8abd2599491cbad959c700b90ba72a5dce8d0"
      ]
    },
    {
      "vendor": "Linux",
      "product": "Linux",
      "versions": [
        "2.6.35",
        "0",
        "4.14.305",
        "4.19.272",
        "5.4.231",
        "5.10.166",
        "5.15.91",
        "6.1.9",
        "6.2"
      ]
    }
  ],
  "Reference": [
    "https://git.kernel.org/stable/c/facf353c9e8d7885b686d9a4b173d4e0af6441d2",
    "https://git.kernel.org/stable/c/e9036e951f93fb8d7b5e9d6e2c7f94a4da312ae4",
    "https://git.kernel.org/stable/c/a8d40942df074f4ebcb9bd3413596d92f323b064",
    "https://git.kernel.org/stable/c/6dd9ea05534f323668db94fcc2726c7a84547e78",
    "https://git.kernel.org/stable/c/ae8e136bcaae96163b5821984de1036efc9abb1a",
    "https://git.kernel.org/stable/c/6aee197b7fbcd61596a78b47d553f2f99111f217",
    "https://git.kernel.org/stable/c/6a19da111057f69214b97c62fb0ac59023970850"
  ]
}