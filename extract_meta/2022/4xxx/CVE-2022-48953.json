{
  "CVE Code": "CVE-2022-48953",
  "Published": "2024-10-21T20:05:40.399Z",
  "Updated": "2025-05-04T08:26:50.082Z",
  "Description": "In the Linux kernel, the following vulnerability has been resolved:\n\nrtc: cmos: Fix event handler registration ordering issue\n\nBecause acpi_install_fixed_event_handler() enables the event\nautomatically on success, it is incorrect to call it before the\nhandler routine passed to it is ready to handle events.\n\nUnfortunately, the rtc-cmos driver does exactly the incorrect thing\nby calling cmos_wake_setup(), which passes rtc_handler() to\nacpi_install_fixed_event_handler(), before cmos_do_probe(), because\nrtc_handler() uses dev_get_drvdata() to get to the cmos object\npointer and the driver data pointer is only populated in\ncmos_do_probe().\n\nThis leads to a NULL pointer dereference in rtc_handler() on boot\nif the RTC fixed event happens to be active at the init time.\n\nTo address this issue, change the initialization ordering of the\ndriver so that cmos_wake_setup() is always called after a successful\ncmos_do_probe() call.\n\nWhile at it, change cmos_pnp_probe() to call cmos_do_probe() after\nthe initial if () statement used for computing the IRQ argument to\nbe passed to cmos_do_probe() which is cleaner than calling it in\neach branch of that if () (local variable \"irq\" can be of type int,\nbecause it is passed to that function as an argument of type int).\n\nNote that commit 6492fed7d8c9 (\"rtc: rtc-cmos: Do not check\nACPI_FADT_LOW_POWER_S0\") caused this issue to affect a larger number\nof systems, because previously it only affected systems with\nACPI_FADT_LOW_POWER_S0 set, but it is present regardless of that\ncommit.",
  "ProblemTypes": [
    "N/A"
  ],
  "Affected": [
    {
      "vendor": "Linux",
      "product": "Linux",
      "versions": [
        "a474aaedac99ba86e28ef6c912a7647c482db6dd",
        "a474aaedac99ba86e28ef6c912a7647c482db6dd",
        "a474aaedac99ba86e28ef6c912a7647c482db6dd",
        "a474aaedac99ba86e28ef6c912a7647c482db6dd"
      ]
    },
    {
      "vendor": "Linux",
      "product": "Linux",
      "versions": [
        "2.6.28",
        "0",
        "5.10.163",
        "5.15.86",
        "6.0.14",
        "6.1"
      ]
    }
  ],
  "Reference": [
    "https://git.kernel.org/stable/c/0bcfccb48696aba475f046c2021f0733659ce0ef",
    "https://git.kernel.org/stable/c/60c6e563a843032cf6ff84b2fb732cd8754fc10d",
    "https://git.kernel.org/stable/c/1ba745fce13d19775100eece30b0bfb8b8b10ea6",
    "https://git.kernel.org/stable/c/4919d3eb2ec0ee364f7e3cf2d99646c1b224fae8"
  ]
}