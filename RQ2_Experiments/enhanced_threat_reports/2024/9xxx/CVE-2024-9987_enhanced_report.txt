CVE-2024-9987 is a post-authentication SQL injection vulnerability affecting
Pandora FMS versions from 700 up to but not including 777.3, specifically within
the `filters` parameter of the `extensions/agents_modules_csv` functionality.
The root cause lies in improper input sanitization of user-supplied data passed
to SQL queries, where the application fails to adequately neutralize special
characters within the `filters` parameter, allowing an authenticated attacker to
inject arbitrary SQL statements into backend queries. This vulnerability is
triggered when a logged-in user submits a crafted HTTP request to the affected
endpoint, embedding malicious SQL code within the `filters` parameter, which is
then executed directly by the database engine without sufficient validation or
parameterization. The exploitation requires prior authentication, meaning the
attacker must possess valid credentials and access to the relevant module, but
once authenticated, the attack can be executed remotely over the network without
any additional user interaction. The attack complexity is low, as no special
conditions or environmental factors are required beyond crafting the malicious
input; standard SQL injection payloads are sufficient to exploit the flaw. The
vulnerability poses a severe risk to data confidentiality and integrity, as
successful exploitation could allow an attacker to exfiltrate sensitive
monitoring data, agent configurations, or stored credentials, and potentially
modify or delete database records, thereby undermining the trustworthiness of
operational data. However, there is no direct evidence suggesting that
availability is impacted, as the flaw does not inherently cause service
disruption or denial of service. In real-world scenarios, a malicious insider or
a compromised user account could be used to exploit this vulnerability to
escalate access, harvest sensitive information, or tamper with monitoring
configurations to evade detection. For instance, an attacker could extract
credential hashes or inject false monitoring data to mislead administrators. To
mitigate this vulnerability, organizations should upgrade to Pandora FMS version
777.3 or later, where the issue has been addressed through proper input
validation and query parameterization. Additionally, administrators should audit
user access controls to limit exposure, monitor for anomalous database queries,
and consider implementing web application firewalls (WAFs) to detect and block
SQL injection attempts. Given the clear technical documentation, reproducibility
of the exploit under standard conditions, and alignment with known SQL injection
patterns, the confidence level in this intelligence assessment is high.